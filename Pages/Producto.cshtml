@page
@model GestionClientesMyM.Pages.ProductoModel
@{
}

<table class="table table-bordered">
	<thead>
		<tr>
			<th>Producto</th>
			<th>Descripcion</th>
			<th>Precio inicial</th>
			<th>Detalles</th>
		</tr>
	</thead>
	<tbody>
		@for(int i = 0; i < Model.Productos.Count; i++)
		{
			var producto = Model.Productos[i];
			<tr>
				<td>@producto.Nombre</td>
				<td>@producto.Descripcion</td>
				<td>@producto.PrecioInicial.ToString("C")</td>
				<td>
					<button class="btn btn-primary btn-sm" onclick="toggleDetalles(@i)" title="Ver detalles">
						<i class="bi bi-eye"></i>
					</button>
					<a asp-page="ProductoABM" asp-route-id="@producto.Id" class="btn btn-primary btn-sm" title="Editar">
						<i class="bi bi-pencil"></i>
					</a>
					<form method="post" asp-page-handler="DeleteProducto" class="d-inline">
						<input type="hidden" name="id" value="@producto.Id" />
						<button type="submit" class="btn btn-danger btn-sm" title="Eliminar">
							<i class="bi bi-trash"></i>
						</button>
					</form>
				</td>
			</tr>
			<tr id="detalles-@i" style="display:none;">
				<td colspan="6">
					<table class="table table-sm table-hover">
						<thead>
							<tr>
								<th>Version</th>
								<th>Descripcion</th>
								<th>Costo inicial</th>
							</tr>
						</thead>
						<tbody>
							@foreach(var version in producto.ProductosVersiones)
							{
								<tr>
									<td>@version.Nombre</td>
									<td>@version.Descripcion</td>
									<td>@version.CostoInicial.ToString("C")</td>
								</tr>
							}
						</tbody>
					</table>
				</td>
			</tr>
		}
	</tbody>
</table>

<a class="btn btn-success mb-2" asp-page="ProductoABM">Agregar</a>


<script>
	function toggleDetalles(index) {
		var fila = document.getElementById("detalles-" + index);
		if (fila.style.display === "none") {
			fila.style.display = "table-row";
		} else {
			fila.style.display = "none";
		}
	}
</script>